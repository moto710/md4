<html xmlns:th="http://www.thymeleaf.org" lang="en">

<th:block th:fragment="js">
    <!-- Bootstrap core JavaScript-->
    <script src="/assets/vendor/jquery/jquery.min.js"></script>
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="/assets/js/sb-admin-2.min.js"></script>

    <script src="/assets/sweetalert2/v11.7.0/sweetalert2.min.js"></script>
    <script src="/assets/jquery-validate/v1.19.5/jquery.validate.min.js"></script>

    <!-- Page level plugins -->
    <script src="/assets/vendor/datatables/jquery.dataTables.min.js"></script>
    <script src="/assets/vendor/datatables/dataTables.bootstrap4.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="/assets/js/demo/datatables-demo.js"></script>
    <script src="/assets/js/appBase.js"></script>
    <script>
        const page = {
            urls: {
                signup: AppBase.API_SIGNUP
            },
            elements: {},
            commands: {},
            loadData: {},
            dialogs: {
                elements: {},
                commands: {}
            }
        }

        page.elements.usernameSup = $("#usernameSup");
        // page.elements.emailReg = $("#emailReg");
        page.elements.passwordSup = $("#passwordSup");
        // page.elements.rePasswordReg = $("#rePasswordReg");
        page.elements.btnSignup = $("#btnSignup");

        page.commands.createProduct = () => {
            let userDTO = {
                username: page.elements.usernameSup.val(),
                password: page.elements.passwordSup.val()
            }

            console.log(userDTO)

            $.ajax({
                headers: {
                    'accept': 'application/json',
                    'content-type': 'application/json'
                },
                type: "POST",
                url: page.urls.signup,
                data: JSON.stringify(userDTO)
            })
                .done((data) => {
                    console.log(data);
                    console.log("register");
                    location.href = '/products';

                    AppBase.successAlert("Signup success!");
                })
                .fail((jqXHR) => {
                    console.log(jqXHR)
                    console.log("fail");
                    console.log(userDTO)
                    AppBase.errorAlert("Signup fail!");
                })
        }

        page.initializeControlEvent = () => {
            page.elements.btnSignup.on("click", function () {
                page.commands.createProduct();
            });
        }

        $(() => {
            page.initializeControlEvent();
        })
    </script>

</th:block>